<?xml version="1.0"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
         xmlns:s="library://ns.adobe.com/flex/spark"
         creationComplete="onCreationComplete(event)">

    <fx:Script>
        <![CDATA[
        import managers.PopupManager;
        import managers.State;

        import mx.events.FlexEvent;

        import spark.events.TextOperationEvent;

        import ui.popups.PopupInfo;

        private function onCreationComplete(event:FlexEvent):void
        {
            State.dispatcher.addEventListener("stateChanged", function (event:Event):void
            {
                validate();
            });

            if (!State.loaded)
                State.loadLocal();

            setTimeout(validateStep, 500);
        }

        private function validateStep():void
        {
            // Checks what step the generation process is on and acts accordingly

            var step:int = State.read("step");
            if (step == 0)
            {
                // No steps yet taken, start sequence from the beginning
                var p:PopupInfo = new PopupInfo();
                p.header = "Before you begin";
                p.description = "Before you begin text";
                p.callback = function ():void
                {
                    State.write("step", 1);
                };

                PopupManager.open(p);
            } else
            {
                trace("!");
            }
        }

        private function onChangeFoo(event:TextOperationEvent):void
        {
            //State.write("test.foo", inputFoo.text);

        }

        private function validate():void
        {
            //inputFoo.text = State.read("test.foo");
        }
        ]]>
    </fx:Script>
    <s:VGroup width="100%"
              height="100%">
        <s:HGroup width="100%"
                  height="100%">

        </s:HGroup>
    </s:VGroup>
</s:Group>
